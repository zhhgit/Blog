---
layout: post
title: "JS处理JSON"
description: JS处理JSON
modified: 2015-07-21
category: JavaScript
tags: [JavaScript]
featured: true
---

在做汇率查询的一个需求，涉及到从后台请求数据，所以用到JSON，记一些JSON相关的东西。

# 一、JSON是什么

w3school链接<http://www.w3school.com.cn/json/index.asp>

JSON：JavaScript 对象表示法（JavaScript Object Notation）。JSON 是存储和交换文本信息的语法。类似 XML。JSON 比 XML 更小、更快，更易解析。

例子

	<html>
	<body>
	<h2>在 JavaScript 中创建 JSON 对象</h2>
	<p>
	Name: <span id="jname"></span><br />
	Age: <span id="jage"></span><br />
	Address: <span id="jstreet"></span><br />
	Phone: <span id="jphone"></span><br />
	</p>
	<script type="text/javascript">
	var JSONObject= {
	"name":"Bill Gates",
	"street":"Fifth Avenue New York 666",
	"age":56,
	"phone":"555 1234567"};
	document.getElementById("jname").innerHTML=JSONObject.name
	document.getElementById("jage").innerHTML=JSONObject.age
	document.getElementById("jstreet").innerHTML=JSONObject.street
	document.getElementById("jphone").innerHTML=JSONObject.phone
	</script>
	</body>
	</html>

JSON 数组:

	{
	"employees": [
	{ "firstName":"John" , "lastName":"Doe" },
	{ "firstName":"Anna" , "lastName":"Smith" },
	{ "firstName":"Peter" , "lastName":"Jones" }
	]
	}

通过JavaScript可以创建一个对象数组，并像这样进行赋值：

	var employees = [
	{ "firstName":"Bill" , "lastName":"Gates" },
	{ "firstName":"George" , "lastName":"Bush" },
	{ "firstName":"Thomas" , "lastName": "Carter" }
	];

可以像这样访问JavaScript对象数组中的第一项：

	employees[0].lastName;

# 二、JSON的操作

在Javascript操作JSON对象，增加、删除、修改

	<script type="text/javascript">
		var jsonObj2 = { teacher: [
			{ name: "jordan", sex: "m", age: "40" },
			{ name: "bryant", sex: "m", age: "28" },
			{ name: "McGrady", sex: "m", age: "27" }
		]};
	
		var jsonObj2New = {};
		$("#btn").click(function () {
			//invoke the update
			updateData("jordan");
			var persons = jsonObj2.teacher;
			for (var i = 0; i < persons.length; i++) {
				var cur_person = persons[i];
				alert(cur_person.sex);
			}
	
			//invoke the delete
			deleteData("jordan");
			var persons = jsonObj2.teacher;
			for (var i = 0; i < persons.length; i++) {
				var cur_person = persons[i];
				alert(cur_person.sex);
			}

			//push 
			var temp = { name: "kenny", sex: "m", age: "25" };
			jsonObj2.teacher.push(temp);
	
			var persons = jsonObj2.teacher;
			for (var i = 0; i < persons.length; i++) {
				var cur_person = persons[i];
				alert(cur_person.name);
			}

		});

		function updateData(name) {
			var persons = jsonObj2.teacher;
			//alert(name);
			for (var i = 0; i < persons.length; i++) {
				var cur_person = persons[i];
				if (cur_person.name == name) {
					persons[i].sex = "f";
				}
			}
		}

		function deleteData(name) {
			var persons = jsonObj2.teacher;
			//alert(name);
			for (var i = 0; i < persons.length; i++) {
				var cur_person = persons[i];
				if (cur_person.name == name) {
					jsonObj2.teacher.splice(i, 1);
				}
			}
		}
		</script>

# 三、JSON的转换

首先，JSON字符串:

	var str1 = '{ "name": "cxh", "sex": "man" }';

1.JSON字符串转换为JSON对象，要运用上面的str1，必须运用下面的要领先转化为JSON对象：

	var obj = eval('(' + str + ')');

或者

	var obj = str.parseJSON(); //由JSON字符串转换为JSON对象

或者

	var obj = JSON.parse(str); //由JSON字符串转换为JSON对象

2.可以运用toJSONString()或者JSON.stringify()将JSON对象转化为JSON字符串。

例如：

	var last=obj.toJSONString(); //将JSON对象转化为JSON字符

或者

	var last=JSON.stringify(obj); //将JSON对象转化为JSON字符