---
layout: post
title: "JS闭包"
description: JS闭包
modified: 2015-08-20
category: JavaScript
tags: [JavaScript]
featured: true
---

# 一、什么是闭包

参与银联钱包JS-SDK的开发，一开始对于UPSDK.js的写法感到不解。通过看了网上一些博客对闭包的概念有了一些理解。写下帮助记忆。

简单说：在函数体内定义另外的方法函数，而这个方法函数被函数以外的变量引用，这时就形成了闭包。

# 二、典型例子

例子1：

	<script type="text/javascript">  
	 function A(){
	    var S=0;
	    function B(){
	        alert(++S);
	    }
	    return B;
	}
	var C=A();
	C();
	</script>

例子2：计时

错误：因为setTimeout异步执行了

	for(var i=0,delay=1000; i< 5; i++, delay +=1000) {
	    setTimeout(function() {
	        console.log('i:' + i + " delay:" + delay);
	    }, delay);
	}

输出：

	i:5 delay:6000
	i:5 delay:6000
	i:5 delay:6000
	i:5 delay:6000
	i:5 delay:6000


正确：

	for(var i=0, delay=1000; i < 5; i++, delay += 1000) {
	    (function(a, _delay) { 
	        setTimeout(function() { 
	            console.log('i:'+a+" delay:"+_delay);
	        }, _delay);
	    })(i, delay);
	}

输出：

	i:0 delay:1000
	i:1 delay:2000
	i:2 delay:3000
	i:3 delay:4000
	i:4 delay:5000

# 三、闭包用途

1、可以读取函数内部的变量

2、让这些变量始终保持在内存中

# 四、参考

1.[关于JS中的闭包浅谈](http://www.jb51.net/article/40819.htm)

2.[JS闭包](http://kingsmalltwo.iteye.com/blog/1962583)

3.[学习 JavaScript 最难点之二 -- 理解closure(闭包)](http://www.douban.com/note/293295975/)

4.[js词法作用域、调用对象与闭包](http://www.nowamagic.net/librarys/veda/detail/1305)