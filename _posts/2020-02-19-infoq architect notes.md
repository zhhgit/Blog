---
layout: post
title: "InfoQ架构师笔记"
description: InfoQ架构师笔记
modified: 2020-02-19
category: 架构
tags: [架构]
---

# 20190606

1.微服务

问题1：
• 服务雪崩：即一个服务挂了，整个调用链路上的所有的服务都会受到影响；
• 大量请求堆积、故障恢复慢：即一个服务慢，卡住了，整个调用链路出现大量超时，要长时间等待慢的服务恢复到正常状态。
• 服务器资源分配困难，服务器机型碎片化：服务多了，各个团队都要申请服务器，规格不一，要求多样，管理十分困难；
• 一台服务器上多个进程互相影响、QoS难以保障：采用虚拟机或者物理机的部署，往往会多个进程放在一台服务器上，高峰期影响严重；
• 测试环境数量大增，环境管理、部署更新困难：每个团队都有反复部署测试环境，手动部署或者脚本部署过于复杂。

解决1：
• 通过熔断机制，当一个服务挂了，被影响的服务能够及时熔断，使用Fallback数据保证流程在非关键服务不可用的情况下，仍然可以进行。
• 通过线程池和消息队列机制实现异步化，允许服务快速失败，当一个服务因为过慢而阻塞，被影响服务可以在超时后快速失败，不会影响整个调用链路。
• 统一基础设施，拥抱容器标准，解决服务器碎片化和服务之间的隔离问题；
• 统一编排和弹性伸缩平台，2015年拥抱Kubernetes标准，解决了部署困难，环境不一致的问题；
• 打造CI/CD服务，抽象出产品、环境等多级概念，实现从代码到测试到上线的自动部署。

问题2：
• 微服务框架选型不一，技术无法积累，面向业务定制化严重，上手成本高；
• 传统依赖于应用运维的排障复杂度高，传统监控服务无法满足需求；
• 故障演练手段不一，硬编码随处可见；
• API版本管理混乱，无统一的监控，治理，无开发标准；
• 分布式事务支持方式不一，和业务绑定严重。

解决2：
• 微服务框架与开源技术栈统一，将服务治理逻辑抽离、以无侵入方式实现、支持Spring Cloud、Dubbo等开源技术栈；
• 全链路跟踪服务与日志服务依据ID 进行联系，以发现故障点上下文；
• 在Agent引入故障注入服务，可统一进行故障演练；
• 服务通过API网关暴露，引入API管理、测试平台，自动Client SDK生成；
• 实现TCC中间件、事务消息队列等标准中间件。

2.Service Mesh

本质上Service Mesh的出现就是为了解决大规模微服务架构下，请求的高效可靠传输与服务治理的问题。
它将原先实现在微服务框架胖客户端或者API网关接入层的服务治理功能下沉到一个统一的Sidecar代理以一个独立进程的方式部署在业务进程旁边，通过控制面来保障服务间通信的横向流量按照业务的真实需求在整个微服务体系内高效流转。

3.ElasticSearch 是基于Lucene实现的分布式搜索引擎，提供了海量数据实时检索和分析能力。

# 20190508

1.边缘计算：以往集中式的云计算平台由于网络带宽的限制和实时性的要求，存在无法高效地处理海量数据的缺点；而另一方面，随着物联网的兴起，边缘计算平台作为一种新兴的计算平台应运而生。
相对于云计算平台，它搭载了先进、高效而又小巧的AI计算芯片。通过部署在边端，它能够高效地获取数据、及时地对处理后的信息进行反馈，并有效地保证了边端数据的安全。大量设备之间也能够通过数据共享和协同工作的方式，满足各行各业对大数据、实时性，以及安全性的要求。

2.每天在工作之外有16个小时，把工作开始之前的10小时和之后的六小时视为一天的前奏和尾声，这种看法是错误的。
这16小时是“一天中的一天”，在这16小时中，你是自由的，你应该如同一个贵族一样使用自己的时间。在你的娱乐时间做更多的思考。主动思考我们如何度过“一天中的一天”。——《如何度过一天24小时》
而低效的996最大的问题，在于挤占了我们的业余时间，让程序员们失去学习思考、感知创造的时间与精力。天天加班增删查改，写着千篇一律的业务代码，拧十年的螺丝，也不过是个熟练的螺丝工罢了。

3.技术中台：
(1)容器平台，虚拟机
(2)微服务框架(分布式服务框架)&&微服务管理控制台
(3)技术组件
(4)公共基础服务和技术服务
(5)DevOps&&AIOps
(6)效能

# 20190506

1.大数据：
批量：Hive/Impala
实时：Storm/Spark/Flink

2.如果把系统架构比作一个房子，实施混沌工程就类似对房子进行验房的过程。通过模拟有损和无损的的场景来观察房子质量，目标是暴露结构性风险，不会去关注每个细节。

3.Kubernetes 项目一直在做的，其实是在进一步清晰和明确“应用交付”这个亘古不变的话题。
只不过，相比于交付一个容器和容器镜像， Kubernetes 项目正在尝试明确的定义云时代“应用”的概念。
在这里，应用是一组容器的有机组合，同时也包括了应用运行所需的网络、存储的需求的描述。
而像这样一个“描述”应用的YAML文件，放在etcd里存起来，然后通过控制器模型驱动整个基础设施的状态不断地向用户声明的状态逼近，就是Kubernetes的核心工作原理了。

# 20190408

1.文档型数据库MongoDB的核心竞争力在于：
(1)基于JSON的数据模型最接近开发者的面向对象的设计思维；
(2)灵活动态的模型意味着在需求多变的时候极大简化数据库设计流程；
(3)自动分片、多节点自动同步和跨中心能力支持各种现代化复杂部署需求。

2.DDD(领域驱动设计)分层架构各层定义与职能：
(1)展现层：它负责向用户显示信息和解释用户命令，完成前端界面逻辑。这里的用户不一定是使用用户界面的人，也可以是另一个计算机系统。
(2)应用层：它是很薄的一层，负责展现层与领域层之间的协调，也是与其它系统应用层进行交互的必要渠道。应用层要尽量简单，不包含业务规则或者知识，不保留业务对象的状态，只保留有应用任务的进度状态，更注重流程性的东西。它只为领域层中的领域对象协调任务，分配工作，使它们互相协作。
(3)领域层：它是业务软件的核心所在，包含了业务所涉及的领域对象（实体、值对象）、领域服务以及它们之间的关系，负责表达业务概念、业务状态信息以及业务规则，具体表现形式就是领域模型。领域驱动设计提倡富领域模型，即尽量将业务逻辑归属到领域对象上，实在无法归属的部分则以领域服务的形式进行定义。
(4)基础设施层：它向其他层提供通用的技术能力，为应用层传递消息（API网关等），为领域层提供持久化机制（如数据库资源）等。

3.Umi：React全家桶 + dva + jest + antd (mobile) + less + eslint

# 20190308

1.微服务三个阶段：
微服务1.0，仅使用注册发现，基于SpringCloud或者Dubbo进行开发，目前意图实施微服务的传统企业大部分处于这个阶段，或者正从单体应用，向这个阶段过渡，处于0.5的阶段；
微服务2.0，使用了熔断，限流，降级等服务治理策略，并配备完整微服务工具和平台，目前大部分互联网企业处于这个阶段。传统企业中的领头羊，在做互联网转型的过程中，正在向这个阶段过渡，处于1.5的阶段；
微服务3.0，Service Mesh将服务治理作为通用组件，下沉到平台层实现，使得应用层仅仅关注业务逻辑，平台层可以根据业务监控自动调度和参数调整，实现AIOps和智能调度。目前一线互联网公司在进行这方面的尝试。

2.AWS Firecracker是一种利用KVM的新虚拟化技术：基于内核的虚拟机（Kernel-based Virtual Machine，简称KVM）是在Linux内核中运行并将内核视为其管理程序的VM。可以同时运行多个KVM，并且像典型的VM一样，每个KVM都有自己的虚拟化硬件。

# 20190208

1.滴滴的跨端框架Chameleon。

2.Kubeflow旨在支持多种机器学习框架运行在Kubernetes之上，比如Tensorflow, Pytorch, Caffe等常见框架。

3.Dubbo的实践和演进。

4.一个比较典型的DevOps的流水线过程是：项目开始开发时，用VS Code开发代码，然后把代码推送到GitLab里存储，通过GitLab的hook使Jenkins执行一些CI的过程，比如做一些单元测试，构建Docker image，再把这个Docker image调用helm部署到开发环境或测试环境中。在测试环境里通过Jenkins触发一个集成测试的功能，完成后就可以把它部署到生产环境里，通过Kubernetes addon的方式，把Prometheus、Grafana等监控组件部署到集群里，就实现了一整套从CI到CD的监控过程。

5.云主机IO加速技术极大提升了机械盘随机写的处理能力。

# 20190108

1.flink实时流处理。阿里巴巴blink。批处理全量与流处理增量。

2.系统间通信，同步使用RPC框架例如Dubbo，异步使用消息队列例如Kafka。

3.客户端一致性：

    begin tx开启本地事务
    do work执行业务操作
    insert message向同实例消息库插入消息
    end tx事务提交
    send message网络向server发送消息
    reponse server回应消息
    delete message如果server回复成功则删除消息
    scan messages补偿任务扫描未发送消息
    send message补偿任务补偿消息
    delete messages补偿任务删除补偿成功的消息

4.Kafka等消息中间件都是基于patition存储模型的，comsumer个数应该与同一subject的partition对应。不利于扩容缩容。

5.技术发展
在软件架构领域，经历了从单体应用到SOA再到微服务；
在云计算领域，经历了从虚拟机到容器；
在数据库领域，从关系数据库到NoSQL再到NewSQL；
在大数据领域，从批处理到流处理；
在运维领域，从手工运维到DevOps、AIOps；
在前端领域，从jQuery到React等三大框架；

6.Web网站屏蔽底层硬件差异，管理网络编排。